# Mobile UX/Visual Refresh 実装タスクリスト（詳細版）

> 目的：`plans/mobile-ux-refresh-plan.md` の設計を、実装時に迷いなく進められるように**具体タスクに分解**する。
> 前提：Web が仕様の一次情報。機能差は作らない（Parity 最優先）。

## 0. 事前準備（必須）
- [x] `docs/feature_parity.md` を確認し、Web⇄Mobile の差分を一覧化する（画面/機能/導線の3軸で列挙し、差分は列ごとに理由を付記）。`plans/mobile-ux-parity-diff.md` に整理。
- [ ] モバイル主要導線（Home / Projects / Issue / Search / Notifications / Profile / Setup）を一巡してスクリーンショットを取得し、`plans/assets/` に画面名+日付で保存する。
- [x] 既存 UI コンポーネントを `apps/mobile/components/*` から一覧化し、用途/利用画面/改善対象を表で整理する。`plans/mobile-ux-component-inventory.md` に整理。
- [x] 実装順を確定し、1週間ごとのスコープを定義する（例：Week1=Foundation、Week2=Cards/Buttons、Week3=Home/Issue）。`plans/mobile-ux-weekly-scope.md` に整理。
- [x] 影響範囲を整理し、変更対象のディレクトリとファイルを列挙する（apps/mobile / packages/core / packages/storage）。`plans/mobile-ux-impact-scope.md` に整理。
- [x] デザインレビューの判定基準を作成する（Before/After の差分、可読性、コントラスト、操作回数を採点表にする）。`plans/mobile-ux-review-criteria.md` に整理。

## 1. デザインシステムの実装（foundation）
### 1-1. カラートークン整備
- [x] `apps/mobile/constants/theme.ts` を拡張して以下を追加し、Light/Dark で対応表を作成する
  - [x] Brand（primary/secondary）
  - [x] Surface（base/raised/overlay）
  - [x] Text（primary/secondary/tertiary/disabled）
  - [x] State（success/warning/error/info）
  - [x] Border（subtle/strong）
- [x] Light/Dark で**コントラスト基準**を合わせ、主要テキストはWCAG AA相当を満たす配色にする。
- [x] 状態色は「背景用の淡色」と「文字/強調用の濃色」のペアで定義し、使い分けルールを1ページにまとめる。
- [x] 既存の色参照を新トークンに置換するマイグレーション方針を決め、`rg "#"` でハードコード色を検出し置換計画を作る。
- [x] 残存するハードコード色をすべてトークン化する（例: `apps/mobile/app/(tabs)/profile.tsx`, `apps/mobile/app/issue/[issueId].tsx`, `apps/mobile/app/(tabs)/notifications.tsx`）。

### 1-2. タイポグラフィ階層
- [x] `ThemedText` に type を追加（Display/Headline/Body/Caption 等）し、各typeの `fontSize/lineHeight/fontWeight` を定義する。
- [x] 全画面で統一するため、各画面の主要テキストに type を適用し、未適用箇所をチェックリスト化する。
- [x] 見出し/本文/注釈の使い分けルールを文章化し、1画面につき最大3階層までに制限する。

### 1-3. Elevation/角丸/余白
- [x] Elevation を 3〜4 段に定義し、カード/モーダル/シート/フローティングに割り当てる。
- [x] 角丸サイズのルール（例: 8/12/16）を定義し、既存カード/ボタンの角丸を置換する。
- [ ] 8pt grid に合わせて `StyleSheet` の padding/margin を調整し、全画面のズレがある箇所を修正する。
- [x] 余白サイズの命名ルール（xs/s/m/l/xl）を追加し、共通の spacing 定数として利用する。

## 2. 共通コンポーネント刷新
### 2-1. Card コンポーネント
- [x] `IssueCard` に新しい surface/影/境界線を適用し、Light/Dark両方で可読性を確認する。
- [ ] `ProjectCard` 相当のコンポーネントがあれば同様に適用し、カード構成を統一する。
- [ ] 状態バッジを共通チップに移行し、各カードで同一スタイルを使用する。
- [ ] カードのタップ領域・hover/pressed の視覚表現を統一し、押下時は明度変化+縮小を入れる。

### 2-2. ボタン / CTA
- [x] Primary / Secondary / Ghost の 3種を定義し、背景/文字/枠線の色をトークン化する。
- [x] Haptics（expo-haptics）でタップ時の反応を統一し、Primaryのみ強めのフィードバックにする。
- [x] タップ領域を 44px 以上確保し、狭い箇所を洗い出して修正する。
- [x] ボタンのdisabled/loading状態を定義し、スピナー表示と押下不可を全画面で統一する。

### 2-3. バッジ / チップ
- [x] Status / Priority / Due 用の共通チップを作成し、ラベルと色の対応表を定義する。
- [x] 意味色の乱用を防ぐため、意味色の用途を「状態・優先度・期限切れ」に限定する。
- [x] テキスト長が長い場合は2行禁止・省略記号対応とし、最大幅を定める。

### 2-4. フォーム / 入力
- [x] TextInput のラベル・フォーカス時の強調・エラー表示を統一し、フォーカス時はブランド色の枠線を適用する。
- [x] `SelectionSheet` の選択状態を視覚的に明確化し、選択中はチェック+背景色で表現する。
- [ ] 送信前バリデーションとエラーメッセージの文言ガイドを定義し、曖昧語を避けるテンプレートを作成する。
- [x] フォーム入力のフォーカス/エラー表示の共通化（Inputコンポーネント検討）を行い、全画面へ適用する。

## 3. 画面単位の実装タスク
### 3-1. Home
- [x] ヘッダーにヒーロー領域を設け、「今日の目的」と要約数値を並べる。
- [x] 統計カードをダッシュボード化し、3枚の幅/高さ/余白を揃える。
- [x] CTA「課題を作成」をPrimaryボタン化し、ファーストビューに配置する。
- [x] Home の主要指標にはアクセント色を1箇所のみ適用し、視線誘導を作る。

### 3-2. Issue Detail
- [x] ステータス/優先度/期限/担当者を上部のサマリーカードに集約する。
- [x] コメント/履歴は時系列順リストにし、区切り線と余白で読みやすくする。
- [x] アクション（編集/更新）は固定位置のCTAに配置して常に見えるようにする。
- [x] 期限切れ/高優先度は状態チップで強調し、色とアイコンで識別可能にする。

### 3-3. Projects
- [x] Project のカード構造を統一し、タイトル/進捗/期限の順で配置する。
- [x] 進行中/完了/期限の視認性を強化し、状態色と進捗バーを追加する。
- [x] 空状態デザインを改善し、ブランドメッセージ+CTAを配置する。
- [x] プロジェクトのスター/ピン状態はアイコン色と位置を固定し、誤認しない表現にする。

### 3-4. Search
- [x] フィルタチップを状態色で整理し、選択中は塗りつぶし+チェックを表示する。
- [x] 検索結果の並び替えを UI 上明確化し、並び替えメニューを常時表示する。
- [x] 直近検索・保存フィルタはセクション分けし、上部に固定表示する。

### 3-5. Notifications
- [x] 未読/既読の視認性を改善し、未読は太字+アクセント色で表示する。
- [x] 重要通知の優先度表示を追加し、優先度チップで区別する。
- [x] 既読化アクションのフィードバックはトースト+色変化を統一し、1秒以内に表示する。

### 3-6. Profile
- [x] 統計・設定・アクションの階層を整理し、セクションごとにカード化する。
- [x] ユーザー情報の視認性を改善し、名前/役割/連絡先を上部に配置する。
- [x] 危険操作（リセット等）は警告色と二段階確認を統一し、誤タップ防止を入れる。

### 3-7. Setup / Onboarding
- [x] 初回体験のトーン設計として、見出しとサブコピーを設定し安心感を強調する。
- [x] ステップ進行状況を視覚化し、現在地/残りステップ数を表示する。
- [x] 初回セットアップ完了後の案内を明確化し、「次にやること」CTAを表示する。

## 4. モーション & マイクロインタラクション
- [x] ボタンタップ時のスケール/フェードを追加し、200ms以内のアニメーションに統一する。
- [x] リスト追加/削除のアニメーションを統一し、挿入はフェード+スライド、削除はフェードアウトにする。
- [x] スケルトン/ローディングにブランドの演出を付与し、明度差のあるグラデーションを使う。
- [x] 画面遷移の速度とイージングを統一し、OS標準のイージングカーブに合わせる。

## 5. 品質ゲート & チェックリスト
- [x] `npm --workspace apps/mobile run lint` を実行し、警告/エラーをゼロにする。
- [x] `npm --workspace apps/mobile run typecheck` を実行し、型エラーを解消する。
- [ ] Web/Mobile の同一ストーリー検証（作成→更新→削除）を各画面で実施し、結果を記録する。
- [ ] 実機（屋外/暗所）で視認性チェックを行い、読みづらい箇所を改善する。
- [ ] docs/feature_parity.md に差分がないか確認し、差分があれば理由を明記する。
- [ ] 主要画面のBefore/After比較を保存（スクリーンショット）し、レビュー資料に添付する。

## 実装の進め方（推奨順）
1. **デザインシステム**（色/タイポ/余白/elevation）
2. **共通コンポーネント**（Card/Button/Chip/Form）
3. **画面ごとの調整**（Home → Issue → Projects → Search → Notifications → Profile）
4. **モーション**（アニメーション & haptics）
5. **品質ゲート**（lint/typecheck/実機確認）
